<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upload Flayer Pelatihan</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-[48%] max-w-[24rem] bg-white rounded-lg shadow-lg p-3">
    <h1 class="text-[1.44rem] font-bold mb-3 text-center">Upload Flayer Pelatihan</h1>
    <form id="uploadForm" class="space-y-2.5">
      <div>
        <label for="judul" class="block mb-1 font-semibold text-gray-700">Judul:</label>
        <input type="text" id="judul" class="w-full border border-gray-300 rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500" required />
      </div>
      <div>
        <label for="deskripsi" class="block mb-1 font-semibold text-gray-700">Deskripsi:</label>
        <textarea id="deskripsi" rows="4" class="w-full border border-gray-300 rounded-md p-1.5 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500" required></textarea>
      </div>
      <div>
        <label for="mentor" class="block mb-1 font-semibold text-gray-700">Mentor:</label>
        <input type="text" id="mentor" class="w-full border border-gray-300 rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500" required />
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-1.5">
        <div>
          <label for="hari" class="block mb-1 font-semibold text-gray-700">Hari:</label>
          <input type="text" id="hari" class="w-full border border-gray-300 rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500" required />
        </div>
        <div>
          <label for="bulan" class="block mb-1 font-semibold text-gray-700">Bulan:</label>
          <input type="text" id="bulan" class="w-full border border-gray-300 rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500" required />
        </div>
        <div>
          <label for="tahun" class="block mb-1 font-semibold text-gray-700">Tahun:</label>
          <input type="text" id="tahun" class="w-full border border-gray-300 rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-blue-500" required />
        </div>
      </div>
      <div>
        <label for="gambar" class="block mb-1 font-semibold text-gray-700">Upload Gambar:</label>
        <input type="file" id="gambar" accept="image/*" class="w-full" required />
      </div>
      <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-1.5 rounded-md transition-colors duration-300">
        <i class="fas fa-upload mr-2"></i> Upload
      </button>
    </form>
    <p id="statusUpload" class="mt-2 text-center text-green-600 font-medium"></p>
  </div>

  <script>
    const firebaseConfig = { /* isi konfigurasi Firebase kamu */ };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    const form = document.getElementById("uploadForm");
    const statusUpload = document.getElementById("statusUpload");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      statusUpload.textContent = "";
      const judul = document.getElementById("judul").value.trim();
      const deskripsi = document.getElementById("deskripsi").value.trim();
      const mentor = document.getElementById("mentor").value.trim();
      const hari = document.getElementById("hari").value.trim();
      const bulan = document.getElementById("bulan").value.trim();
      const tahun = document.getElementById("tahun").value.trim();
      const fileInput = document.getElementById("gambar");
      if (!fileInput.files.length) {
        statusUpload.textContent = "Mohon pilih gambar untuk diupload.";
        statusUpload.classList.remove("text-green-600");
        statusUpload.classList.add("text-red-600");
        return;
      }
      const file = fileInput.files[0];
      const namaGambar = `${Date.now()}-${file.name}`;

      try {
        const storageRef = storage.ref().child("flayer/" + namaGambar);
        await storageRef.put(file);
        const url = await storageRef.getDownloadURL();

        await db.collection("flayer").add({
          judul,
          deskripsi,
          mentor,
          hari,
          bulan,
          tahun,
          gambar: url,
          namaGambar,
          createdAt: new Date()
        });

        statusUpload.textContent = "Berhasil mengunggah flayer pelatihan.";
        statusUpload.classList.remove("text-red-600");
        statusUpload.classList.add("text-green-600");
        form.reset();
      } catch (error) {
        statusUpload.textContent = "Terjadi kesalahan saat mengunggah: " + error.message;
        statusUpload.classList.remove("text-green-600");
        statusUpload.classList.add("text-red-600");
      }
    });
  </script>
</body>
</html>
